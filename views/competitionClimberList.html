


{% extends "skala3ma-layout.html" %}

{% block topcontent %}


{% endblock %}


	{% block secondarycontent %}

		{% include "competition-menu.html" %}

        <!-- competitionClimberList.html -->
		<!--div id="fh5co-blog-section" class="fh5co-section-gray"	-->
					<div class="container">
                        <div class="text-center heading-section">


						<br>
						<h3>{{ reference_data['current_language'].competition_climber_list }} <br>
								{{competition['name'] }} - {{ competition['date']| strftime(format='short')}}</h3>

						<font color="red">	{{ reference_data['current_language'][error_code] }} </font>

					    </div>
                    </div>





{% if climber is not none and climber is not undefined  %}
climber is not none
<div class="container-flex">
	<div class="row">
				{{ reference_data['current_language'].name}} {{ climber['name'] }}
	            ({{ climber['sex'] }} ) from <i>{{climber['club'] }}</i>



				{{ climber['routesClimbed'] }}

    </div>
</div>

	<div class="table-responsive">
			<form target="/competitionDashboard/{{competitionId}}/updateRoutes">
            <table class="table"><tr>

					{% for i in range(100) %}
                    <td style="width:10%">

						<h3>	<a href="#" onclick="document.getElementById('route{{i}}').checked=!document.getElementById('route{{i}}').checked; return false;">
								 {{i}}</a>


								<input type="checkbox" id="route{{i}}" name="route{{i}}" value="{{i}}"
								{% if i in climber['routesClimbed'] %}checked{% endif %} ></h3>

</td>
	{% if i%10==9 %} </tr><tr> {% endif %}

</td>

					{%endfor%}
</tr>
			</table>
				<button class="btn btn-success btn-lg">Submit</button>
				</form>

</div>
	</div>
				{% endif %}




{% if competition is not none and competition is not undefined  %}

<!--onclick="location.href='/competitionRoutesEntry/{{ competitionId }}/climber/{{ climberId}}'"-->
<style>
/* Minimal responsive layout for climbers list */
#climberList { display:flex; flex-direction:column; gap:.5rem; }
.climber-row { display:flex; flex-direction:column; padding:.5rem .75rem; border:1px solid #ddd; border-radius:4px; background:#fff; }
@media (min-width:600px){ .climber-row { flex-direction:row; align-items:center; } }
.climber-name { font-size:1.2rem; font-weight:500; display:flex; align-items:center; gap:.5rem; }
.presence-badge { display:inline-block; width:1.25rem; height:1.25rem; line-height:1.25rem; text-align:center; border-radius:50%; font-size:.85rem; font-weight:600; }
.presence-badge.present { background:#198754; color:#fff; }
.presence-badge.absent { background:#6c757d; color:#fff; }
.climber-meta { display:flex; flex-wrap:wrap; gap:.75rem; font-size:.9rem; margin-top:.25rem; }
@media (min-width:600px){ .climber-meta { margin-top:0; margin-left:1rem; } }
/* registration status badge */
.reg-status { padding:0 .6rem; border-radius:12px; font-size:.6rem; font-weight:600; letter-spacing:.5px; text-transform:uppercase; }
.reg-status.registered { background:#198754; color:#fff; }
.reg-status.waitlist { background:#ffc107; color:#000; }
.reg-status.hide { display:none; }
/* thin bars indicator for routes (no goal background) */
.routes-bars { display:flex; align-items:flex-end; gap:2px; height:16px; margin-top:2px; }
.routes-bar { width:3px; background:#198754; border-radius:2px 2px 0 0; animation:grow .4s ease-out; }
@keyframes grow { from { transform:scaleY(0); } to { transform:scaleY(1); } }
</style>
<div id="climberList">
	{# iterate over climbers preserving existing Jinja notation #}
	{% for climberId in competition['climbers'] %}
		{% set c = competition['climbers'][climberId] %}
		<div class="climber-row">
			<div class="climber-name">
				<a href="/competitionRoutesEntry/{{ competitionId }}/climber/{{ climberId}}"><b>{{ c['name'] }}</b></a>
				
				{% set rs = c.get('registration_status','')|lower %}
				<span class="reg-status registered {% if 'register' in rs and not 'wait' in rs %}show{% else %}hide{% endif %}" data-translate-key="Registered" title="Registered">Registered</span>
				<span class="reg-status waitlist {% if 'wait' in rs %}show{% else %}hide{% endif %}" data-translate-key="Waitlist" title="Waitlist">Waitlist</span>
                {% if c.get('present') %}
				<span class="presence-badge present" title="Present" >âœ”</span>
				{% endif %}
			</div>
			<div class="climber-meta">
				<span>{{ c['sex'] }}</span>
				<span><i>{{ c['club'] }}</i></span>
				{# Determine category translation key based on competition_type (0 adult, 1 youth) and category index #}
				{% set cat_prefix = 'adult' if competition['competition_type'] == 0 else 'youth' %}
				{% set cat_key = 'competition_category_' ~ cat_prefix ~ '_' ~ c['category'] %}
				<span data-translate-key="{{ cat_key }}">{{ reference_data['current_language'].get(cat_key, reference_data['categories'][c['category']]) }}</span>
				{# Thin bars indicator: one bar per route up to 50 #}
				{% set route_count = c['routesClimbed']|length %}
				{% set maxbars = 50 %}
				{% set show = maxbars if route_count > maxbars else route_count %}
				<a href="/competitionRoutesEntry/{{ competitionId }}/climber/{{ climberId}}" alt="Click to edit">
                <div class="routes-bars" aria-label="{{ route_count }} routes" title="{{ route_count }} routes climbed">
					{% for i in range(show) %}
					<span class="routes-bar" style="height:{% if route_count>0 %}{{ 6 + ( (i / show) * 8 )|round(0,'floor') }}{% else %}0{% endif %}px"></span>
					{% endfor %}
				
                <span>{{ route_count }}</span></div></a>
			
			</div>
		</div>
	{% endfor %}
</div>







				{%endif %}



			</div>
		</div>
		<!-- fh5co-blog-section -->

	</div>
		</div>

{% endblock %}